<!doctype html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Messages</title>
</head>
<style>
html, body{
    height: 100%;
    padding: 0;
    margin: 0;
}
body{
    display: flex;
    flex-direction: column;
    height: 100vh;
}
#mainDiv{
    flex: 1;
    background-color: silver;
}


#leftDiv{
    /* flex:auto; */
    flex-direction: column;
    float: left;
    min-width: 35%;
    border-radius: 8px;
    margin-left: 20px;
    margin-top: 20px;
    min-height: 95%;
    background-color: #FFFFFF;
}

#viewMessage{
    float: left;
    min-width: 61%;
    margin-top: 20px;
    margin-left: 20px;
    border-radius: 8px;
    min-height: 95%;
    background-color: #FFFFFF;
}

#messageLabel{
    margin-left: 150px;
    font-size: 23px;
    font-style: italic;
    width: 5vh;
    
}
#messageList{
    /* flex: 1; */
    margin-top: 5vh;
    height: 78vh;
    overflow-y: auto;
}

#senderContent > span:first-child{
    display: inline-block;
    margin-left: 10px;
    font-size: 30px;
}

#senderContent > span:nth-child(2){
    opacity: 0.7 !important;
    display: block;
    margin-left: 10px;
}

.eachMessage{
    display: block;
    width: 390px;
    overflow: hidden;
    transition: background-color 0.3s ease; 

}


.eachMessage :hover{
    background-color: bisque;
}

.displayImage{
    height: 60px;
    width: 60px;
    display: inline-block;
    border-radius: 50%;
}

#senderImage{
    padding-left: 10px;
    float:left;
    height: 100%;
}

#senderContent{
    padding-left: 10px;
    float: left;
    height: 100%;
}

#viewMessageHeader{
    float: left;
    width: 100%;
    height: 58px;
    border-bottom: 1px gray solid;
}

.headerDisplayImage{
    height: 40px;
    width: 40px;
    /* display: inline-block; */
    border-radius: 50%;
    float: left;
    padding-left:12px;
    padding-top:12px;
}

.headerName{
    float: left;
}


</style>
<script src="https://code.jquery.com/jquery-3.6.0.min.js" type="text/javascript"></script>
<script type="text/javascript">

// $('#senderContent').click(function(event){
//     const chatHeader = document.getElementById('viewMessageHeader');
//     chatHeader.innerHTML = '';

//     const imageSrc = document.createElement('img');
//     imageSrc.src=event.
// })

function senderContentClick(image, senderName){
    alert("image name = " + image);
       const chatHeader = document.getElementById('viewMessageHeader');
       chatHeader.innerHTML = '';

       const imageSrc = document.createElement('img');
       imageSrc.src=image;
       imageSrc.className='headerDisplayImage';
       chatHeader.appendChild(imageSrc);

       const span = document.createElement('span');
       span.textContent=senderName;
       span.className='headerName';
       chatHeader.appendChild(span);
}
</script>
<script src="/js/commonjs.js" type="text/javascript"></script>
<link href="/css/common.css?v=123" rel="stylesheet" type="text/css">
<body>
<div th:replace="header.html"></div>
<div id="mainDiv">

<div id="leftDiv">
<span id="messageLabel">Chat</span>
<div id="messageList">
        <div th:each="message : ${messageList.allMessage}" class="eachMessage">
            <div id="senderImage">
                <img class="displayImage" th:src="${message.senderPicture}" th:alt="${message.senderName}"/>
            </div>
            <div id="senderContent" th:attr="data-sender-picture=${message.senderPicture}, data-sender=${message.senderName}" onclick="senderContentClick(this.dataset.senderPicture, this.dataset.sender)">
                <span th:text="${message.senderName}"></span>
                <span th:text="${message.content}"></span>
            </div>
        
        </div>
</div>
</div>
<div id="viewMessage">
    <div id="viewMessageHeader">
        <!-- <img src="" class="headerDisplayImage"/>
        <span id=""></span> -->
    </div>
</div>
<div th:replace="menu.html"></div>
</div>
</body>
</html>